{% extends 'base.html' %}

{% block content %}
<div class="container p-3 my-3 border">
<div class="row">

    <div class="col">
        <h1>Tribe name : {{Tribe.name}}</h1>

        <img src="{{Tribe.image.url}}" style="max-width: 400px; max-height: 400px; min-width: 100px; min-height: 100px;"> 
        <hr>
        

        {% if request.user in Users and request.user != Tribe.chieftain %}
            
            <img src="https://cfl-cfl.com/wp-content/uploads/2019/08/Member-Icon.png"
             style="height: 90px;">
             <br><span>You are member in {{Tribe.name}}</span><br>
             <form action="{% url 'leave_tribe' Tribe.id %}" method="POST">
                {% csrf_token %}
                <button class="btn btn-info m-2" type="submit"  style="margin:10px;">Leave Tribe</button>
            </form>
            <br>
        {% else %}
            {% if request.user != Tribe.chieftain %}
                {% if user.is_authenticated %}
                    <form  action=" {% url 'join_tribe' Tribe.id %} " method="POST">
                        {% csrf_token %}
                        <button class="btn btn-info m-2" type="submit"  style="margin:10px;">Join Tribe</button>
                    </form>

                    <br>
                {% endif %}
            {% endif %}
        {% endif %} 
        <hr>
    </div>

    <div class="col">
        <h5>Members:</h5>
        {% if not Users %}
            <span>Nobody joined this Tribe yet</span>
        {% endif %}
        <ul>
            {% for i in Users %}
                {% if request.user == i %}
                    <li><b>(You) {{i}}</b></li>
                {% else %}
                    <li>{{i}}</li>
                {% endif %}
                {% if request.user == Tribe.chieftain or request.is_staff %}
                {% if i != Tribe.chieftain  %}
                <form action="{% url 'kick_member' Tribe.id i.id %}" method="POST">
                    {% csrf_token %}
                    <button type="submit"  class="m-2">Kick member</button>
                </form>
                {% endif %}
                {% endif %}
            {% endfor %}
        </ul>
        <hr>

        {% if request.user == Tribe.chieftain %}
        <div class="jumbotron">
        <center>
            <a href="{% url 'create_playlist' Tribe.id %}"><button class="btn btn-info m-2">Create new playlist</button></a>
        </center>
        </div>
        {% endif %}

        {% if playlists %}
        <h4>Playlist list : </h4>
            {% for i in playlists %}
            <div class="jumbotron">
                Playlist name : {{i.name}} <br>
                Playlist description : {{i.description}}
                {% if request.user == Tribe.chieftain %}
                    <form action="{% url 'delete_playlist' i.id %}" method="post">
                        {% csrf_token %}
                        <input type="submit" class="float-right btn btn-info m-2" value="Delete playlist">
                    </form>
                    <a href="{% url 'edit_playlist' i.id %}"><button class="float-right btn btn-info m-2">Edit playlist info</button></a> <br>
                {% endif %}
            </div>
            {% endfor %}
        {% else %}
            <h4>No playlists created in this tribe yet.</h4>
        {% endif %}
    </div> 
<div>
   
</div>
{% endblock %}
